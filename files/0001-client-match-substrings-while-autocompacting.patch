From b8babd4aba65c85e3e4e9f0d6b5d827d220096de Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?C=C3=A9dric=20Bellegarde?= <cedric.bellegarde@adishatz.org>
Date: Fri, 3 Sep 2021 11:39:09 +0200
Subject: [PATCH] client: match substrings while autocompleting contacts. Fix
 #1144. Fix #984.

---
 src/client/application/application-contact-store.vala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/client/application/application-contact-store.vala b/src/client/application/application-contact-store.vala
index bf9916491..67e5dd339 100644
--- a/src/client/application/application-contact-store.vala
+++ b/src/client/application/application-contact-store.vala
@@ -116,7 +116,7 @@ public class Application.ContactStore : Geary.BaseObject {
 
         Folks.SearchView view = new Folks.SearchView(
             this.individuals,
-            new Folks.SimpleQuery(query, FOLKS_GENERAL_MATCH_FIELDS)
+            new Folks.SimpleQuery("%".concat(query, "%"), FOLKS_GENERAL_MATCH_FIELDS)
         );
         yield view.prepare();
 
@@ -158,7 +158,7 @@ public class Application.ContactStore : Geary.BaseObject {
 
         Gee.Collection<Geary.Contact> engine_results =
             yield this.account.contact_store.search(
-                query, min_importance, limit, cancellable
+                "%".concat(query, "%"), min_importance, limit, cancellable
             );
         foreach (Geary.Contact contact in engine_results) {
             string email_key = to_cache_key(contact.email);
-- 
GitLab

